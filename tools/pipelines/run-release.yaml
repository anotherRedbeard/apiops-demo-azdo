trigger:
  branches:
    include:
      - main
  paths:
    include:
      - 'devportal-artifacts/**'

pr:
  branches:
    include:
      - main
  paths:
    include:
      - 'devportal-artifacts/**'

jobs:
- job: release-dev
  displayName: 'Release to Dev'
  pool:
    vmImage: 'ubuntu-latest'
  steps:
  - template: ./tools/pipelines/release-with-env.yaml
    parameters:
      ENVIRONMENT: 'Dev'
      OUTPUT_FOLDER_PATH: ${{ parameters.OUTPUT_FOLDER_PATH }}

- job: release-stage
  displayName: 'Release to Stage'
  dependsOn: release-dev
  pool:
    vmImage: 'ubuntu-latest'
  steps:
  - template: ./tools/pipelines/release-with-env.yaml
    parameters:
      ENVIRONMENT: 'Prod'
      OUTPUT_FOLDER_PATH: ${{ parameters.OUTPUT_FOLDER_PATH }}
